<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>学校事務職員16タイプ診断</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Red+Hat+Display:wght@500;600;700&family=Noto+Sans+JP:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg: #f6f7fb;
            --text: #0f172a;
            --muted: #5f6b7c;
            --card: #ffffff;
            --accent: #48c0b7;
            --accent-dark: #3a8bd8;
            --accent-soft: #d8f2f0;
            --border: #dde3f5;
            --agree: #00b894;
            --agree-soft: #c9f4e9;
            --disagree: #f76b9a;
            --disagree-soft: #ffd9e7;
            --neutral: #94a3b8;
        }

        * {
            box-sizing: border-box;
        }

        body {
            margin: 0;
            font-family: "Noto Sans JP", "Hiragino Kaku Gothic ProN", "Meiryo", sans-serif;
            color: var(--text);
            background: var(--bg);
            line-height: 1.6;
        }

        h1, h2, h3 {
            font-family: "Red Hat Display", "Noto Sans JP", sans-serif;
            letter-spacing: 0.02em;
        }

        .hero {
            background: linear-gradient(130deg, #35c1a4 0%, #6c8cff 55%, #9570ff 100%);
            color: #fff;
            padding: 4rem 1.5rem 6rem;
            position: relative;
            overflow: hidden;
        }

        .hero::after {
            content: "";
            position: absolute;
            inset: 0;
            background: radial-gradient(circle at 20% 20%, rgba(255,255,255,0.35), transparent 55%);
            opacity: 0.8;
            pointer-events: none;
        }

        .hero-inner {
            position: relative;
            max-width: 1100px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 2.5rem;
            align-items: center;
        }

        .hero-text h1 {
            margin: 0 0 1rem;
            font-size: clamp(2.2rem, 4vw, 3rem);
        }

        .eyebrow {
            display: inline-block;
            text-transform: uppercase;
            font-size: 0.85rem;
            letter-spacing: 0.2em;
            margin-bottom: 1rem;
            color: rgba(255,255,255,0.8);
        }

        .hero-points {
            list-style: none;
            padding: 0;
            margin: 1.5rem 0 0;
            display: grid;
            gap: 0.8rem;
        }

        .hero-points li {
            display: flex;
            gap: 0.75rem;
            align-items: center;
            padding: 0.6rem 0.7rem;
            border-radius: 0.8rem;
            background: rgba(255, 255, 255, 0.12);
        }

        .hero-points li span {
            font-weight: 600;
            color: #fff;
        }

        .hero-card {
            background: rgba(255, 255, 255, 0.18);
            border-radius: 1.2rem;
            padding: 1.8rem;
            backdrop-filter: blur(6px);
            box-shadow: 0 25px 40px rgba(15, 23, 42, 0.15);
        }

        .hero-card h2 {
            margin: 0 0 0.5rem;
            font-size: 1.6rem;
        }

        .hero-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin: 1rem 0 0;
        }

        .hero-tag {
            padding: 0.35rem 0.75rem;
            border-radius: 999rem;
            background: rgba(255,255,255,0.2);
            font-size: 0.9rem;
        }

        main {
            max-width: 1280px;
            margin: -120px auto 0;
            padding: 0 2.5rem 4rem;
        }

        .card {
            background: var(--card);
            border-radius: 1.2rem;
            padding: 2rem;
            box-shadow: 0 24px 60px rgba(15, 23, 42, 0.08);
            border: 1px solid var(--border);
        }

        .progress-section {
            margin-bottom: 2rem;
        }

        .progress-header {
            display: flex;
            justify-content: space-between;
            align-items: baseline;
            margin-bottom: 0.4rem;
        }

        .progress-title {
            font-size: 0.85rem;
            text-transform: uppercase;
            letter-spacing: 0.2em;
            color: var(--muted);
        }

        .progress-count {
            font-size: 1.4rem;
            font-weight: 700;
        }

        .progress-percent {
            font-weight: 600;
            color: var(--accent);
        }

        .progress-bar {
            width: 100%;
            height: 10px;
            border-radius: 999rem;
            background: #e7e8f5;
            overflow: hidden;
        }

        .progress-fill {
            width: 0;
            height: 100%;
            background: linear-gradient(135deg, var(--accent), var(--accent-dark));
            border-radius: inherit;
            transition: width 0.3s ease;
        }

        ol.question-list {
            list-style: none;
            padding: 0;
            margin: 0;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(560px, 1fr));
            gap: 1.6rem;
        }

        .question {
            border: 1px solid var(--border);
            border-radius: 1.1rem;
            padding: 1.6rem 1.6rem 2rem;
            background: #eef1f7;
            transition: border 0.25s ease, box-shadow 0.25s ease, background 0.25s ease;
        }

        .question:hover,
        .question.answered {
            border-color: var(--accent);
            background: #fff;
            box-shadow: 0 16px 30px rgba(14, 116, 144, 0.14);
        }

        .question h3 {
            margin: 0 0 1rem;
            font-size: 1.05rem;
        }

        .scale {
            display: grid;
            grid-template-columns: minmax(220px, 1fr) auto minmax(220px, 1fr);
            gap: 1.8rem;
            align-items: center;
            background: #fff;
            padding: 1.4rem 1.3rem;
            border-radius: 1.05rem;
            box-shadow: inset 0 0 0 1px #dfe4f3;
        }

        .scale-label {
            font-weight: 500;
            font-size: 0.95rem;
            color: #717b9b;
        }

        .scale-label.left {
            text-align: right;
            color: var(--agree);
        }

        .scale-label.right {
            color: var(--disagree);
        }

        .scale-buttons {
            position: relative;
            display: flex;
            gap: 0.85rem;
            align-items: center;
            padding: 1.2rem 1.5rem;
        }

        .scale-buttons::before {
            content: "";
            position: absolute;
            left: 1.5rem;
            right: 1.5rem;
            top: 50%;
            transform: translateY(-50%);
            height: 5px;
            border-radius: 999rem;
            background: linear-gradient(90deg, rgba(0,184,148,0.4), rgba(148,163,184,0.4), rgba(247,107,154,0.4));
        }

        .scale-choice {
            position: relative;
            display: inline-flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
        }

        .scale-choice input {
            position: absolute;
            opacity: 0;
            pointer-events: none;
        }

        .scale-choice span {
            display: inline-block;
            border-radius: 50%;
            background: #c8cfde;
            transition: transform 0.2s ease, background 0.2s ease, box-shadow 0.2s ease, opacity 0.2s ease;
            opacity: 0.85;
        }

        .scale-choice.strong span {
            width: 44px;
            height: 44px;
        }

        .scale-choice.medium span {
            width: 36px;
            height: 36px;
        }

        .scale-choice.light span {
            width: 30px;
            height: 30px;
        }

        .scale-choice.neutral span {
            width: 26px;
            height: 26px;
        }

        .scale-choice input:focus-visible + span {
            outline: 3px solid #94a3b8;
            outline-offset: 3px;
        }

        .scale-choice.left input:checked + span {
            background: var(--agree);
            box-shadow: 0 0 0 6px var(--agree-soft);
            opacity: 1;
        }

        .scale-choice.right input:checked + span {
            background: var(--disagree);
            box-shadow: 0 0 0 6px var(--disagree-soft);
            opacity: 1;
        }

        .scale-choice.neutral input:checked + span {
            background: var(--neutral);
            box-shadow: 0 0 0 6px rgba(148, 163, 184, 0.25);
            opacity: 1;
        }

        .form-actions {
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            margin-top: 2.2rem;
        }

        button {
            border: none;
            border-radius: 999rem;
            padding: 0.95rem 2.2rem;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            font-family: inherit;
        }

        #submitBtn {
            background: linear-gradient(120deg, var(--accent), var(--accent-dark));
            color: #fff;
            box-shadow: 0 12px 24px rgba(73, 56, 186, 0.35);
        }

        #resetBtn {
            background: rgba(15, 23, 42, 0.08);
            color: #1f2937;
        }

        .alert {
            margin-top: 1rem;
            color: #b45309;
            font-weight: 600;
            display: none;
        }

        .result {
            margin-top: 2.5rem;
            display: none;
            border-left: 6px solid var(--accent);
            animation: fadeIn 0.4s ease;
        }

        .type-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.4rem 0.9rem;
            border-radius: 999rem;
            background: var(--accent-soft);
            color: var(--accent-dark);
            font-weight: 600;
        }

        .group-tag {
            display: inline-block;
            padding: 0.3rem 0.8rem;
            border-radius: 999rem;
            background: #ffeac2;
            color: #a35000;
            font-size: 0.85rem;
            margin-bottom: 0.8rem;
        }

        .axis-result {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 1rem;
            margin-top: 1.5rem;
        }

        .axis-card {
            border: 1px solid var(--border);
            border-radius: 1rem;
            padding: 1rem;
            background: #f9f9ff;
        }

        .axis-card strong {
            display: block;
            margin-bottom: 0.4rem;
        }

        .axis-scores {
            font-size: 0.9rem;
            color: var(--muted);
            display: flex;
            flex-direction: column;
            gap: 0.2rem;
        }

        .result-visual {
            margin: 1.5rem 0;
            display: flex;
            justify-content: center;
        }

        .result-visual__bubble {
            position: relative;
            padding: 1.4rem;
            border-radius: 1.5rem;
            background: linear-gradient(150deg, rgba(72, 192, 183, 0.18), rgba(149, 112, 255, 0.15));
            box-shadow: 0 30px 40px rgba(31, 41, 55, 0.18);
            overflow: hidden;
        }

        .result-visual__bubble::before {
            content: "";
            position: absolute;
            width: 220px;
            height: 220px;
            background: radial-gradient(circle, rgba(255,255,255,0.8), transparent 70%);
            top: -40px;
            right: -30px;
            filter: blur(5px);
        }

        .result-visual img {
            position: relative;
            max-width: 360px;
            width: 100%;
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(8px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @media (max-width: 900px) {
            .hero {
                padding: 3rem 1.25rem 4.5rem;
            }

            main {
                margin: -70px auto 0;
                padding: 0 1.5rem 3rem;
            }

            .card {
                padding: 1.5rem;
            }

            .scale {
                grid-template-columns: 1fr;
                padding: 1rem 0.9rem;
            }

            .scale-label.left {
                text-align: left;
                margin-bottom: 0.2rem;
            }

            .scale-buttons {
                justify-content: center;
                padding: 1rem 0.5rem;
            }

            ol.question-list {
                grid-template-columns: 1fr;
            }

            .question {
                padding: 1.3rem;
            }
        }

        @media (max-width: 640px) {
            main {
                margin: -40px auto 0;
                padding: 0 1rem 2.5rem;
            }

            .hero-inner {
                gap: 1.5rem;
            }

            .hero-card {
                padding: 1.2rem;
            }

            .scale-buttons {
                flex-wrap: wrap;
                gap: 0.8rem;
                padding: 0.8rem 0;
            }

            .scale-buttons::before {
                display: none;
            }

            .scale-choice.strong span {
                width: 32px;
                height: 32px;
            }

            .scale-choice.medium span {
                width: 28px;
                height: 28px;
            }

            .scale-choice.light span {
                width: 24px;
                height: 24px;
            }

            .scale-choice.neutral span {
                width: 20px;
                height: 20px;
            }

            .result-visual__bubble {
                padding: 1rem;
            }

            .result-visual img {
                max-width: 260px;
                margin: 0 auto;
            }
        }
    </style>
</head>
<body>
    <header class="hero">
        <div class="hero-inner">
            <div class="hero-text">
                <div class="eyebrow">Icebreak Diversity Test</div>
                <h1>学校事務職員16タイプ診断</h1>
                <p>U/W・G/K・R/N・M/Sの4軸で、個性豊かな16タイプを表示するWEB診断です。公務員研修の冒頭で多様性への気づきを促すのにぴったり。両端の主張から自分に近い丸をクリックしてください。</p>
                <ul class="hero-points">
                    <li><span>10問</span> 強さの違う7つの〇から選択（3〜4分）</li>
                    <li><span>4軸×16タイプ</span> MBTI風コード＆愛称で結果表示</li>
                    <li><span>多様性</span> 優劣ではなく「違いを楽しむ」診断</li>
                </ul>
            </div>
            <div class="hero-card">
                <h2>4 Axes</h2>
                <p>U/W（エネルギー）<br>G/K（改善スタンス）<br>R/N（判断基準）<br>M/S（仕事の進め方）</p>
                <div class="hero-tags">
                    <span class="hero-tag">Uchi-komori</span>
                    <span class="hero-tag">Waigaya</span>
                    <span class="hero-tag">Genjō-iji</span>
                    <span class="hero-tag">Kaizen-suishin</span>
                    <span class="hero-tag">Ronri / Nattoku</span>
                    <span class="hero-tag">Maedaoshi / Shimekiri</span>
                </div>
            </div>
        </div>
    </header>

    <main>
        <section class="card">
            <div class="progress-section">
                <div class="progress-header">
                    <div>
                        <div class="progress-title">回答状況</div>
                        <div class="progress-count"><span id="answeredCount">0</span>/10</div>
                    </div>
                    <div class="progress-percent" id="progressPercent">0%</div>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
            </div>

            <form id="quizForm">
                <ol id="questionList" class="question-list"></ol>
                <div class="form-actions">
                    <button type="button" id="submitBtn">診断する</button>
                    <button type="reset" id="resetBtn">リセット</button>
                </div>
                <p id="formAlert" class="alert">未回答の設問があります。</p>
            </form>
        </section>

        <section id="result" class="card result"></section>
    </main>

    <script>
        const questions = [
            {
                id: "q1",
                prompt: "提出期限までまだ余裕のある仕事。あなたならどうする？",
                left: "A：早めに手を付けて、心の余裕を確保したい",
                right: "B：ギリギリの方が集中できるので、今は他の仕事をする",
                axis: { left: "M", right: "S" }
            },
            {
                id: "q2",
                prompt: "先生から規則ギリギリの予算執行の相談を受けた。あなたの最初の対応は？",
                left: "A：「規則ではこうなっています」と事実を正確に伝える",
                right: "B：「お気持ちは分かります」と共感し、一緒に方法を探る",
                axis: { left: "R", right: "N" }
            },
            {
                id: "q3",
                prompt: "複雑な案件について考えをまとめたい時、どうする？",
                left: "A：一人で資料を読み込み、自分の考えを固める",
                right: "B：関係しそうな先生に雑談しながらアイデアを練る",
                axis: { left: "U", right: "W" }
            },
            {
                id: "q4",
                prompt: "新しい会計システムが導入された。あなたの正直な気持ちは？",
                left: "A：慣れた今までのやり方が一番楽だと思う",
                right: "B：どんな機能があるか試してみたくてワクワクする",
                axis: { left: "G", right: "K" }
            },
            {
                id: "q5",
                prompt: "年度当初、仕事の計画を立てるならどんなスタイル？",
                left: "A：締切から逆算して詳細なToDoを作る",
                right: "B：大きな行事だけ把握し臨機応変に動く",
                axis: { left: "M", right: "S" }
            },
            {
                id: "q6",
                prompt: "あなたが仕事で何かを説明する時、より得意なのはどっち？",
                left: "A：根拠やデータを基に論理的に話を進める",
                right: "B：熱意やストーリーで相手の気持ちに訴えかける",
                axis: { left: "R", right: "N" }
            },
            {
                id: "q7",
                prompt: "昼休み、あなたにとって最高のリフレッシュ方法は？",
                left: "A：一人で静かに過ごし、自分のペースで充電する",
                right: "B：同僚や先生方とのおしゃべりで気分転換する",
                axis: { left: "U", right: "W" }
            },
            {
                id: "q8",
                prompt: "毎年恒例の学校行事の担当になった。まず考えることは？",
                left: "A：去年のやり方を振り返り前例を確認する",
                right: "B：今年変えられる新しいことを探す",
                axis: { left: "G", right: "K" }
            },
            {
                id: "q9",
                prompt: "保護者からの問い合わせに答える時、より重視するのは？",
                left: "A：事実や規定を正確に、客観的に伝える",
                right: "B：相手の不安を察し、安心してもらえる説明をする",
                axis: { left: "R", right: "N" }
            },
            {
                id: "q10",
                prompt: "集中して作業したい時、理想の環境はどっち？",
                left: "A：誰にも話しかけられない静かな空間",
                right: "B：人の気配があり、すぐ質問できるオープンな空間",
                axis: { left: "U", right: "W" }
            }
        ];

        const scaleTemplate = [
            { value: 1, strength: "strong", side: "left", label: "とてもA寄り" },
            { value: 2, strength: "medium", side: "left", label: "かなりA寄り" },
            { value: 3, strength: "light", side: "left", label: "ややA寄り" },
            { value: 4, strength: "neutral", side: "neutral", label: "どちらとも言えない" },
            { value: 5, strength: "light", side: "right", label: "ややB寄り" },
            { value: 6, strength: "medium", side: "right", label: "かなりB寄り" },
            { value: 7, strength: "strong", side: "right", label: "とてもB寄り" }
        ];

        const axisMeta = [
            {
                pair: ["U", "W"],
                title: "エネルギーの方向性",
                left: "Uchi-komori（内こもり集中型）",
                right: "Waigaya（ワイガヤ調整型）"
            },
            {
                pair: ["G", "K"],
                title: "改善スタンス",
                left: "Genjō-iji（現状維持派）",
                right: "Kaizen-suishin（改善推進派）"
            },
            {
                pair: ["R", "N"],
                title: "判断の基準",
                left: "Ronri-jūshi（論理重視派）",
                right: "Nattoku-kan（納得感重視派）"
            },
            {
                pair: ["M", "S"],
                title: "仕事の進め方",
                left: "Maedaoshi（前倒し完遂型）",
                right: "Shimekiri-kudō（締切駆動型）"
            }
        ];

        const typeProfiles = {
            UGRM: {
                group: "静かなる守護者",
                title: "頼れる学校の金庫番",
                description: "U（内こもり集中）×G（現状維持）×R（論理）×M（前倒し）の組み合わせであるあなたは、静かな空間で落ち着いて段取りを整えるほど力を発揮します。常に先の締切から逆算して余裕を確保するスタイルが帳票や予算のズレを未然に防ぎ、周りは気づけば大事な工程をあなたに託しています。規則と数値の整合性を守り切る集中力はチーム全体の安心材料であり、人知れず作り込んだ手順書やToDoリストが後輩の心強い支えになっています。あなた自身も「私の丁寧さが組織を落ち着かせている」と胸を張って問題ありません。",
                image: "UGRM型：頼れる学校の金庫番.png"
            },
            UGRS: {
                group: "静かなる守護者",
                title: "年度末の必殺仕分け人",
                description: "U×G×R×Sのあなたは普段は静かに構えつつ、締切が迫るほど集中力が研ぎ澄まされるタイプです。追い込みのタイミングで一気にギアを上げる感覚は怠惰ではなく、自分なりのリズムで短時間でも正確な処理を完遂できる証です。公平性とルールを第一に考える芯があるからこそ、詰めの意思決定でもブレず、周囲は困った瞬間に自然とあなたを頼りにします。最後の数時間で火力を最大化できる稀有な才能を「必殺仕事人」そのものだと自信に変えてください。",
                image: "UGRS型：必殺仕事人.png"
            },
            UGNM: {
                group: "静かなる守護者",
                title: "平和を紡ぐサイレント調整官",
                description: "U×G×N×Mのあなたは、静かに観察しながら人の感情と計画の両方を整える調整力が魅力です。自席で思考を深める時間を確保しつつ、相手が納得できる落としどころを丁寧に探ることで、表に出る前に火種を消すことができます。前倒しで段取りを作る習慣があるため、誰よりも早く関係者の動線を描き、穏やかな声掛けで「このチームは大丈夫」と周囲を安心させます。あなたのさりげない気遣いが、同僚の自己肯定感まで支えていることを忘れないでください。",
                image: "UGNM型：静かなる調整役.png"
            },
            UGNS: {
                group: "静かなる守護者",
                title: "最後の駆け込み寺",
                description: "U×G×N×Sのあなたは、静かな優しさと締切前の瞬発力を併せ持つ駆け込み寺的存在です。尊重すべき前例と柔らかな共感力を軸に、土壇場でも相手に安心を与える言葉を紡げるので、最後の瞬間で状況をひっくり返すスプリントが得意です。普段は内省的に資料を読み込みながらも、必要なときには感情に寄り添った提案と素早い実務で一気に解決へ導けます。あなたがそばにいるだけで「まだ打つ手がある」と感じられること自体が大きな価値であり、その力をもっと誇ってください。",
                image: "UGNS型：事務エンジェル.png"
            },
            UKRM: {
                group: "孤高の改革者",
                title: "業務改善のマエストロ",
                description: "U×K×R×Mのあなたは、静かな集中と改善への意欲を併せ持つ構築型の改革者です。自分のペースで情報を咀嚼し、新しい仕組みを試すことにワクワクできるからこそ、日々の業務に小さなアップデートを積み重ねられます。ロジックに裏付けられた提案と、前倒しで段取りを整える丁寧さが実装スピードを支え、周囲の負担を確実に減らしています。あなたの静かな工夫がどれほど皆を助けているか、ぜひ自分自身にも語り聞かせてください。",
                image: "UKRM型：システム・アーキテクト.png"
            },
            UKRS: {
                group: "孤高の改革者",
                title: "閃きのサイレント革命家",
                description: "U×K×R×Sのあなたは、締切が近づくほどアイデアが冴えるクリエイティブな改革推進者です。静かな集中時間でこっそり検証を進め、直前のひらめきを大胆な改善案として送り出す瞬間に大きな喜びを感じます。思いつきで終わらせず論理的な筋道を用意できるため、スピードと説得力が両立しているのが最大の強みです。自分のリズムを信じれば、今日も誰かの挑戦心をそっと刺激できます。",
                image: "UKRS型：ひらめきの革命家.png"
            },
            UKNM: {
                group: "孤高の改革者",
                title: "穏やかな改革の仕掛人",
                description: "U×K×N×Mのあなたは、改善アイデアを相手のペースに合わせて浸透させるコンサルタント気質の持ち主です。自分の中で十分に練り上げてから提案するため、押し付け感がなく自然と受け入れてもらえる導き方を熟知しています。相手のスケジュールや感情の動きを先読みし、負担の少ない順序で段取りを示せる静かな説得力は、多くの人を安心させる大きな強みです。あなたの柔らかな一声が、誰かの「できるかも」という気持ちをそっと育てています。",
                image: "UKNM型：優しい戦略家.png"
            },
            UKNS: {
                group: "孤高の改革者",
                title: "秘めたる情熱のプレゼンター",
                description: "U×K×N×Sのあなたは、普段は控えめでも伝えるべき瞬間には情熱的に語れるギャップが魅力です。静かな時間にこだわりの改善案を準備し、相手の気持ちを尊重する言葉でプレゼンすると、聴き手の表情が自然と明るくなります。勢いよく仕上げまで持っていける集中力も備えているため、改革の旗振り役として周囲を温かく巻き込めます。あなたの物語性のある説明は誰かの背中を押す力があり、もっと自信を持って発信して大丈夫です。",
                image: "UKNS型：秘めたる情熱家.png"
            },
            WGRM: {
                group: "みんなの調整役",
                title: "安定航路の守護神",
                description: "W×G×R×Mのあなたは、対話を通じて組織を安定航路へ導く堅実なリーダータイプです。現場の感触と規則のバランスをとる舵取りが得意で、会議でも自然と方針を整理して共有する役割を担いがちです。几帳面に計画を立てつつ、人の話を丁寧に受け止める姿勢があるため、あなたがいるだけで場が落ち着き「この船はちゃんと進む」と確信を持てます。周囲の信頼を集めている事実を素直に受け取りましょう。",
                image: "WGRM型：頼れるキャプテン.png"
            },
            WGRS: {
                group: "みんなの調整役",
                title: "頼れる問題解決のヒーロー",
                description: "W×G×R×Sのあなたは、ワイガヤの場で状況を把握し、締切前の瞬発力で問題を着地させる頼れる調整役です。雑談や討議からヒントを集め、最後の一押しで一気に片付ける展開が得意なので、自然と相談が集まります。規則やロジックを軸に判断できるため説明力も高く、「何とかするから任せて」という一言が周囲の自己肯定感を大きく支えているのです。自分のバランス感覚にもっと自信を持ってください。",
                image: "WGRS型：トラブルドクター.png"
            },
            WGNM: {
                group: "みんなの調整役",
                title: "職員室のハッピー調整役",
                description: "W×G×N×Mのあなたは、人の感情に寄り添いながら計画的に物事を整える温かい潤滑油です。会話から元気を得て、誰かの気持ちを言語化して場を柔らかくするのが得意なだけでなく、前例や段取りを丁寧に追えるため、笑顔でスケジュールを伝える姿に周囲は安心感を覚えます。「あなたがいて良かった」と言われるのは偶然ではなく、配慮と準備の積み重ねが生む当然の結果です。",
                image: "WGNM型：事務室の太陽.png"
            },
            WGNS: {
                group: "みんなの調整役",
                title: "人情派ラストミニッツ交渉人",
                description: "W×G×N×Sのあなたは、人との会話から本音を引き出し、締切直前でも粘り強く交渉できる柔軟な橋渡し役です。雑談を通じてアイデアが湧き、追い込みの瞬間に集中力を高められるため、「何とかできる妥協点」を見つけるのが非常に上手です。守るべき前例を尊重しつつ、相手の感情に寄り添う包容力が周囲の「自分も頑張れるかも」という気持ちを自然と引き出しています。",
                image: "WGNS型：ソーシャル・コネクター.png"
            },
            WKRM: {
                group: "未来への推進者",
                title: "未来を創るプロジェクト司令官",
                description: "W×K×R×Mのあなたは、人を巻き込みながら先の展望を描き、計画的に実装へ落とし込める推進力の持ち主です。新しいやり方を歓迎しつつ、対話を通じてアイデアを磨くスタイルがあるため自然とリーダー役を任されやすく、論理と根拠を重んじるためプロジェクト全体の道筋を整理して共有するのが得意です。あなたの描くビジョンは周囲のやる気を高め、組織に「私たちならできる」という空気を生み出します。",
                image: "WKRM型：未来の設計士.png"
            },
            WKRS: {
                group: "未来への推進者",
                title: "常識破りのゲームチェンジャー",
                description: "W×K×R×Sのあなたは、人と議論しながら従来の枠を飛び越えるアイデアを生み出せる革新タイプです。ワイガヤの場で盛り上がりつつ締切が迫るほど冴えるため、勢いだけでなく論理的な裏付けを備えた提案を放つことができます。あなたの存在が職場に「変えてみよう」という前向きさを育てているので、その大胆さを自信に変えてください。",
                image: "WKRS型：常識破りのジョーカー.png"
            },
            WKNM: {
                group: "未来への推進者",
                title: "ビジョンを描く合意形成マスター",
                description: "W×K×N×Mのあなたは、人の思いをすくい上げながら未来の青写真を描き、着実な計画へ落とし込めるストーリーテラーです。対話からエネルギーを得て共感をベースにビジョンを語りつつ、改善アイデアを緻密な行程へ落とし込める珍しい存在です。あなたの言葉が「この職場で自分も活躍できる」と多くの人に思わせていることを誇ってください。",
                image: "WKNM型：夢見るプロデューサー.png"
            },
            WKNS: {
                group: "未来への推進者",
                title: "情熱と勢いのスクール革命家",
                description: "W×K×N×Sのあなたは、人を巻き込む情熱と柔軟な即応力で場を動かすカリスマです。ワイガヤの場を楽しみながら相手の気持ちに寄り添えるため、誰かが迷ったときに自然と力になりたいと思える優しさがあります。勢いのある提案をすぐ実行に移せる行動力を備えているので、あなたの熱さが周囲の自己肯定感を高め、挑戦する空気を自然と広げています。遠慮せずビジョンを叫んでください。",
                image: "WKNS型：情熱のカリスマ.png"
            }
        };



        const form = document.getElementById("quizForm");
        const questionList = document.getElementById("questionList");
        const submitBtn = document.getElementById("submitBtn");
        const formAlert = document.getElementById("formAlert");
        const resultEl = document.getElementById("result");
        const progressFill = document.getElementById("progressFill");
        const answeredCountEl = document.getElementById("answeredCount");
        const progressPercentEl = document.getElementById("progressPercent");

        function renderQuestions() {
            questions.forEach((q, index) => {
                const li = document.createElement("li");
                li.className = "question";
                li.innerHTML = `
                    <h3>Q${index + 1}. ${q.prompt}</h3>
                    <div class="scale">
                        <div class="scale-label left">${q.left}</div>
                        <div class="scale-buttons">
                            ${scaleTemplate.map(option => `
                                <label class="scale-choice ${option.strength} ${option.side}" title="${option.label}">
                                    <input type="radio" name="${q.id}" value="${option.value}" required>
                                    <span></span>
                                </label>
                            `).join("")}
                        </div>
                        <div class="scale-label right">${q.right}</div>
                    </div>
                `;
                questionList.appendChild(li);
            });
            setupAutoAdvance();
        }

        function calculateType() {
            const formData = new FormData(form);
            const totals = { U: 0, W: 0, G: 0, K: 0, R: 0, N: 0, M: 0, S: 0 };
            const answeredQuestions = new Set();

            for (const question of questions) {
                const value = formData.get(question.id);
                if (!value) continue;
                answeredQuestions.add(question.id);
                const numeric = Number(value);
                const weights = [3, 2, 1, 0, 1, 2, 3];
                const weight = weights[numeric - 1];

                if (numeric <= 3) {
                    totals[question.axis.left] += weight;
                } else if (numeric >= 5) {
                    totals[question.axis.right] += weight;
                }
                // neutral (4) adds nothing
            }

            if (answeredQuestions.size < questions.length) {
                formAlert.style.display = "block";
                resultEl.style.display = "none";
                return;
            }

            formAlert.style.display = "none";

            let code = "";
            const axisBreakdown = [];

            axisMeta.forEach(meta => {
                const [left, right] = meta.pair;
                const leftScore = totals[left];
                const rightScore = totals[right];
                let winner = leftScore > rightScore ? left : right;
                if (leftScore === rightScore) {
                    winner = right; // ties lean右側 to prompt再質問
                }
                code += winner;
                axisBreakdown.push({
                    title: meta.title,
                    winner,
                    left,
                    right,
                    leftScore,
                    rightScore,
                    leftLabel: meta.left,
                    rightLabel: meta.right
                });
            });

            const profile = typeProfiles[code];
            renderResult(code, profile, axisBreakdown);
        }

        function renderResult(code, profile, axisBreakdown) {
            if (!profile) {
                resultEl.innerHTML = `<h2>結果: ${code}</h2><p>この組み合わせの説明がまだ登録されていません。</p>`;
            } else {
                const imageBlock = profile.image
                    ? `<div class="result-visual"><div class="result-visual__bubble"><img src="${encodeURI(profile.image)}" alt="${profile.title}のイラスト"></div></div>`
                    : "";
                resultEl.innerHTML = `
                    <span class="group-tag">${profile.group}</span>
                    <div class="type-badge">${code} 型</div>
                    <h2>${profile.title}</h2>
                    ${imageBlock}
                    <p>${profile.description}</p>
                    <h3>軸ごとの内訳</h3>
                    <div class="axis-result">
                        ${axisBreakdown.map(axis => `
                            <div class="axis-card">
                                <strong>${axis.title}</strong>
                                <div class="axis-scores">
                                    <span>${axis.left}（${axis.leftLabel}）：${axis.leftScore}</span>
                                    <span>${axis.right}（${axis.rightLabel}）：${axis.rightScore}</span>
                                </div>
                                <p>⇒ あなたは <strong>${axis.winner}</strong> 傾向です。</p>
                            </div>
                        `).join("")}
                    </div>
                `;
            }

            resultEl.style.display = "block";
            resultEl.scrollIntoView({ behavior: "smooth" });
        }

        function updateProgress() {
            const formData = new FormData(form);
            let answered = 0;
            questions.forEach(q => {
                if (formData.get(q.id)) answered += 1;
            });
            const percent = Math.round((answered / questions.length) * 100);
            progressFill.style.width = `${percent}%`;
            answeredCountEl.textContent = answered;
            progressPercentEl.textContent = `${percent}%`;
        }

        function setupAutoAdvance() {
            const questionItems = Array.from(document.querySelectorAll(".question"));
            questionItems.forEach((item, index) => {
                item.addEventListener("change", event => {
                    if (!event.target.matches("input[type='radio']")) return;
                    item.classList.add("answered");
                    const next = questionItems[index + 1];
                    if (next) {
                        setTimeout(() => {
                            next.scrollIntoView({ behavior: "smooth", block: "center" });
                        }, 150);
                    }
                });
            });
        }

        submitBtn.addEventListener("click", calculateType);
        form.addEventListener("input", updateProgress);
        form.addEventListener("reset", () => {
            setTimeout(() => {
                formAlert.style.display = "none";
                resultEl.style.display = "none";
                document.querySelectorAll(".question").forEach(q => q.classList.remove("answered"));
                updateProgress();
            }, 0);
        });

        renderQuestions();
        updateProgress();
    </script>
</body>
</html>
